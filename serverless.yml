service: happiness-index

package:
  artifact: build/libs/happiness-index-dev-all.jar

custom:
  testBucketName: happiness-index-testbucket

provider:
  name: aws
  runtime: java11
  stage: dev
  region: eu-west-1
  iamRoleStatements:
    - Effect: Allow
      Action:
        - "s3:GetObject"
        - "s3:ListBucket"
        - "s3:PutObject"
      Resource:
        - arn:aws:s3:::${self:custom.testBucketName}/*

functions:
  home:
    handler: happiness.infrastructure.HappinessHandler
    events:
      - http:
          path: /
          method: ANY
  other:
    handler: happiness.infrastructure.HappinessHandler
    events:
      - http:
          path: /{proxy+}
          method: ANY

resources:
  Resources:
    AttachmentsBucket:
      Type: AWS::S3::Bucket
      Properties:
        BucketName: ${self:custom.testBucketName}


# Print out the name of the bucket that is created
Outputs:
  AttachmentsBucketName:
    Value:
      Ref: AttachmentsBucket